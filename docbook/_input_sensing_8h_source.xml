<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="__input_sensing_8h_source" xml:lang="en-US">
<title>InputSensing.h</title>
Go to the documentation of this file.<programlisting linenumbering="unnumbered">1 <emphasis role="comment">//&#32;Input&#32;sensing</emphasis>
2 
3 <emphasis role="preprocessor">#pragma&#32;once</emphasis>
4 
5 <emphasis role="preprocessor">#include&#32;&lt;Arduino.h&gt;</emphasis>
6 <emphasis role="comment">//#include&#32;&lt;MiniDSP.h&gt;</emphasis>
7 
8 <emphasis role="preprocessor">#define&#32;PIN_DIGITAL_TRIGGER&#32;A3</emphasis>
9 <emphasis role="preprocessor">#define&#32;PIN_ANALOG_TRIGGER&#32;A4</emphasis>
10 <emphasis role="preprocessor">#define&#32;PIN_ANALOG_L&#32;A1</emphasis>
11 <emphasis role="preprocessor">#define&#32;PIN_ANALOG_R&#32;A2</emphasis>
12 
13 <emphasis role="preprocessor">#define&#32;ANALOG_SIGNAL_THRESHOLD&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;10&#32;&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;8.8&#32;mV</emphasis>
14 <emphasis role="preprocessor">#define&#32;ANALOG_SIGNAL_HOLDUP&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;10000&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;10&#32;seconds</emphasis>
15 <emphasis role="preprocessor">#define&#32;ANALOG_IMPEDANCE_THRESHOLD&#32;&#32;&#32;&#32;&#32;&#32;0.9&#32;&#32;&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;of&#32;full&#32;scale</emphasis>
16 
17 <emphasis role="comment">//extern&#32;MiniDSP&#32;ourMiniDSP;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;This&#32;may&#32;be&#32;better&#32;as&#32;a&#32;pointer&#32;provided&#32;to&#32;the&#32;constructor.</emphasis>
18 
19 <emphasis role="keyword">class&#32;</emphasis><link linkend="_class_input_sensing">InputSensing</link>&#32;{
20 &#32;&#32;&#32;&#32;
21 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Constructor</emphasis>
22 &#32;&#32;&#32;&#32;<link linkend="_class_input_sensing">InputSensing</link>()&#32;{
23 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_class_input_sensing_1a1ce46cd3a52a686e5590ad655371a78c">Init</link>();
24 &#32;&#32;&#32;&#32;};
25 
26 &#32;&#32;&#32;&#32;<emphasis role="keyword">public</emphasis>:
27 
28 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;@brief&#32;True&#32;if&#32;the&#32;digital&#32;trigger&#32;is&#32;present</emphasis>
29 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="_class_input_sensing_1ae0274696b7a36a8405fe5615c7afae04">digitalTrigger</link>()&#32;{<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_class_input_sensing_1ab0fa35ec20be3d45a33aea10d95a542c">digitalTriggerPresent</link>;};
30 
31 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;@brief&#32;True&#32;if&#32;the&#32;analog&#32;trigger&#32;is&#32;present</emphasis>
32 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="_class_input_sensing_1ab8637f6fe900272b7a907a79886b451c">analogTrigger</link>()&#32;{<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_class_input_sensing_1a1406355e6ecaae16bfedea3725ee0b0d">analogTriggerPresent</link>;};
33 
34 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;@brief&#32;True&#32;if&#32;the&#32;analog&#32;impedance&#32;measures&#32;low</emphasis>
35 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="_class_input_sensing_1a4b25b8cef472f8dfe329159fac76a0f5">analogImpedance</link>()&#32;{<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_class_input_sensing_1a5ee7b0c2b4857c97eea2cff82fbe2a24">analogImpedanceLow</link>;};
36 
37 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;@brief&#32;True&#32;if&#32;there&#32;has&#32;been&#32;recent&#32;analog&#32;signal&#32;activity</emphasis>
38 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="_class_input_sensing_1adb38b54d4c1f51f627dfdf603f041830">analogSignal</link>()&#32;{<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_class_input_sensing_1a8638d7839322eff10c4b7d82217ca2bb">analogSignalPresent</link>;};
39 
40 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Does&#32;all&#32;checks&#32;</emphasis>
41 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_class_input_sensing_1a5a36c1811b90b5f6a5c6b4587d138292">signalChecks</link>();
42 
43 &#32;&#32;&#32;&#32;<emphasis role="keyword">protected</emphasis>:
44 
45 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="_class_input_sensing_1ab0fa35ec20be3d45a33aea10d95a542c">digitalTriggerPresent</link>;
46 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="_class_input_sensing_1a1406355e6ecaae16bfedea3725ee0b0d">analogTriggerPresent</link>;
47 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="_class_input_sensing_1a5ee7b0c2b4857c97eea2cff82fbe2a24">analogImpedanceLow</link>;
48 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="_class_input_sensing_1a8638d7839322eff10c4b7d82217ca2bb">analogSignalPresent</link>;&#32;&#32;<emphasis role="comment">//&#32;True&#32;if&#32;a&#32;signal&#32;is,&#32;or&#32;recently&#32;was,&#32;present</emphasis>
49 
50 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;@brief&#32;True&#32;if&#32;the&#32;analog&#32;source&#32;impedance&#32;appears&#32;to&#32;be&#32;low</emphasis>
51 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="_class_input_sensing_1a2a041de6410815bf42be507d50e1d5b2">analogImpedanceTest</link>();
52 
53 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_class_input_sensing_1a1ce46cd3a52a686e5590ad655371a78c">Init</link>();
54 
55 &#32;&#32;&#32;&#32;<emphasis role="keyword">private</emphasis>:
56 
57 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;uint16_t&#32;analogLastL;
58 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;uint16_t&#32;analogLastR;
59 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;uint32_t&#32;lastSignalTime;
60 };
</programlisting></section>
